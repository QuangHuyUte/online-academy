<div class="row page-enter">
  <div class="col-3">
    {{> sidebar}}
  </div>

  <div class="col-9">
    <!-- ===== Header ===== -->
    <div class="d-flex justify-content-between align-items-center mb-3">
      <div>
        <h3 class="fw-bold mb-0">
          <i class="bi bi-person-badge text-primary me-2"></i> Instructor Detail
        </h3>
        <div class="text-muted small">View profile & recent courses</div>
      </div>
      <a href="/admin/instructors" class="btn btn-outline-secondary">
        <i class="bi bi-arrow-left"></i> Back
      </a>
    </div>

    <!-- ===== Instructor Card ===== -->
    <div class="card shadow-sm border-0 mb-4 card-enter">
      <div class="card-body d-flex flex-wrap gap-3 align-items-center">
        <img src="{{#if instructor.avatar_url}}{{instructor.avatar_url}}{{else}}https://via.placeholder.com/80x80?text=Avatar{{/if}}"
             alt="Avatar" class="rounded border" style="height:100px;width:100px;object-fit:cover;">
        <div class="flex-grow-1">
          <div class="h5 mb-1">{{instructor.name}}</div>
          <div class="text-muted small mb-1">
            <i class="bi bi-envelope me-1"></i>{{instructor.email}}
          </div>
          {{#if instructor.is_available}}
            <span class="badge bg-success-subtle text-success border border-success-subtle">
              <i class="bi bi-check-circle me-1"></i> Available
            </span>
          {{else}}
            <span class="badge bg-secondary">
              <i class="bi bi-lock me-1"></i> Locked
            </span>
          {{/if}}
        </div>
      </div>

      {{#if instructor.bio}}
        <div class="card-footer bg-light">
          <div class="small text-muted mb-1 fw-semibold">
            <i class="bi bi-person-lines-fill me-1"></i> Bio
          </div>
          <div>{{instructor.bio}}</div>
        </div>
      {{/if}}
    </div>

    <!-- ===== Recent Courses ===== -->
    <div class="d-flex justify-content-between align-items-center mb-2">
      <h5 class="fw-semibold mb-0"><i class="bi bi-journal-text me-1"></i> Recent Courses</h5>
      <span class="text-muted small">Total: {{totalCourses}}</span>
    </div>

    {{#if courses.length}}
      <div class="table-responsive card shadow-sm border-0 table-enter">
        <table class="table table-hover align-middle mb-0">
          <thead class="table-light">
            <tr>
              <th style="width:50px;">#</th>
              <th>Title</th>
              <th>Category</th>
              <th style="width:120px;">Price</th>
              <th style="width:140px;">Status</th>
              <th style="width:160px;">Updated</th>
            </tr>
          </thead>
          <tbody>
            {{#each courses}}
              <tr>
                <td>{{inc @index}}</td>
                <td class="fw-semibold text-truncate" style="max-width:240px;">{{this.title}}</td>

                <td class="text-truncate" style="max-width:200px;">
                  {{#if this.category}}
                    {{this.category}}
                  {{else}}
                    <span class="text-muted small">#{{this.cat_id}}</span>
                  {{/if}}
                </td>

                <td>
                  {{#if this.promo_price}}
                    <span class="text-decoration-line-through text-muted me-1 small">{{formatCurrency this.price}}</span>
                    <strong>{{formatCurrency this.promo_price}}</strong>
                  {{else}}
                    {{#if this.price}}
                      {{formatCurrency this.price}}
                    {{else}}
                      <span class="text-muted">—</span>
                    {{/if}}
                  {{/if}}
                </td>

                <td>
                  {{#if this.is_completed}}
                    <span class="badge bg-success-subtle text-success border border-success-subtle">
                      <i class="bi bi-check-circle me-1"></i> Completed
                    </span>
                  {{else}}
                    <span class="badge bg-warning-subtle text-warning border border-warning-subtle">
                      <i class="bi bi-clock-history me-1"></i> Draft
                    </span>
                  {{/if}}
                  {{#if this.is_removed}}
                    <span class="badge bg-secondary ms-1">Hidden</span>
                  {{/if}}
                </td>

                <td class="text-muted small">
                  {{#if this.last_updated_at}}
                    {{formatDate this.last_updated_at "DD/MM/YYYY HH:mm"}}
                  {{else}}—{{/if}}
                </td>
              </tr>
            {{/each}}
          </tbody>
        </table>
      </div>
    {{else}}
      <div class="alert alert-info d-flex align-items-center gap-2 mt-3">
        <i class="bi bi-info-circle"></i>
        <div>This instructor hasn't published any course yet.</div>
      </div>
    {{/if}}
  </div>
</div>

<!-- ===== CSS & Motion ===== -->
<style>
  @media (prefers-reduced-motion:no-preference){
    .page-enter{animation:fadeUp .4s ease-out both}
    .card-enter{animation:fadeUp .45s .03s ease-out both}
    .table-enter{animation:fadeUp .5s .06s ease-out both}
  }
  @keyframes fadeUp{from{opacity:0;transform:translateY(8px)}to{opacity:1;transform:none}}

  .badge {
    font-size: .85rem;
    padding: .4em .6em;
  }
  .table tbody tr:hover {
    background: rgba(13,110,253,.05);
    transition: background .2s ease;
  }
</style>
