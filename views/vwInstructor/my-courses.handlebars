<div class="container py-4">
  <div class="d-flex justify-content-between align-items-center mb-3">
    <h3 class="mb-0">My Courses</h3>
    <a class="btn btn-primary" href="/instructor/courses/new">
      <i class="bi bi-plus-circle"></i> New Course
    </a>
  </div>

  {{> flash}}

  {{#if courses.length}}
    <div class="table-responsive">
      <table class="table table-hover align-middle">
        <thead class="table-light">
          <tr>
            <th>#</th>
            <th>Title</th>
            <th>Category</th>
            <th>Price</th>
            <th>Status</th>
            <th class="text-end">Action</th>
          </tr>
        </thead>
        <tbody>
          {{#each courses}}
          <tr>
            <td>{{inc @index}}</td>

            <td class="text-truncate" style="max-width: 320px;">
              <a href="/instructor/courses/{{this.id}}/edit" class="text-decoration-none">{{this.title}}</a>
              <div class="small text-muted">
                {{#if this.last_updated_at}}
                  Updated: {{formatDate this.last_updated_at "DD/MM/YYYY HH:mm"}}
                {{/if}}
              </div>
            </td>

            <td>
              {{#if this.category}}
                {{this.category}}
              {{else}}
                {{this.cat_id}}
              {{/if}}
            </td>

            <td>
              {{#if this.promo_price}}
                <span class="text-decoration-line-through me-1">
                  {{formatCurrency this.price}}
                </span>
                <strong>{{formatCurrency this.promo_price}}</strong>
              {{else}}
                {{#if this.price}}
                  {{formatCurrency this.price}}
                {{else}}
                  ‚Äî
                {{/if}}
              {{/if}}
            </td>

            <td>
              {{#if this.is_completed}}‚úÖ Completed{{else}}üïì Draft{{/if}}
              {{#if this.is_removed}}
                <span class="badge bg-secondary ms-1">Hidden</span>
              {{/if}}
            </td>

            <td class="text-end">
              <a href="/instructor/courses/{{this.id}}/edit" class="btn btn-sm btn-outline-primary">
                Edit
              </a>

              {{#unless this.is_completed}}
                <form action="/instructor/courses/{{this.id}}/complete" method="post" class="d-inline"
                      onsubmit="return confirm('Mark this course as completed?');">
                  <button class="btn btn-sm btn-success"
                          {{#if this._cannotComplete}}
                            disabled title="C·∫ßn √≠t nh·∫•t 1 Section v√† 1 Lesson"
                          {{/if}}>
                    Mark Completed
                  </button>
                </form>
              {{/unless}}
            </td>
          </tr>
          {{/each}}
        </tbody>
      </table>
    </div>

    {{!-- Pagination (buildPagination helper) --}}
    {{#with (buildPagination page totalPages "/instructor/my-courses") as |p|}}
      <nav aria-label="Courses pages">
        <ul class="pagination justify-content-center mt-3">
          {{#if p.hasPrev}}
            <li class="page-item">
              <a class="page-link" href="{{p.prevUrl}}">Prev</a>
            </li>
          {{/if}}

          {{#each p.pages}}
            <li class="page-item {{#if this.active}}active{{/if}}">
              <a class="page-link" href="{{this.url}}">{{this.page}}</a>
            </li>
          {{/each}}

          {{#if p.hasNext}}
            <li class="page-item">
              <a class="page-link" href="{{p.nextUrl}}">Next</a>
            </li>
          {{/if}}
        </ul>
      </nav>
    {{/with}}
  {{else}}
    <div class="alert alert-info d-flex justify-content-between align-items-center">
      <div>B·∫°n ch∆∞a c√≥ kho√° h·ªçc n√†o.</div>
      <a class="btn btn-primary" href="/instructor/courses/new">
        <i class="bi bi-plus-circle"></i> Create your first course
      </a>
    </div>
  {{/if}}
</div>
